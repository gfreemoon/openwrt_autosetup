#!/bin/sh

###–£—Å—Ç–∞–Ω–æ–≤–∫–∞ curl
opkg update
opkg remove kmod-ipt-nat
opkg install curl luci-i18n-base-ru luci-i18n-commands-ru luci-i18n-firewall-ru luci-i18n-opkg-ru luci-i18n-ttyd-ru kmod-nls-cp866 kmod-nls-utf8 kmod-nls-cp1251 kmod-nf-nat tailscale tailscaled

###–§–∏–∫—Å DPI-–¥—É—Ä–∏–ª–æ–∫ (Zapret, YouTubeUnblock) —Å Hardware/Software Offloading
sed -i 's/meta l4proto { tcp, udp } flow offload @ft;/meta l4proto { tcp, udp } ct original packets ge 30 flow offload @ft;/g' /usr/share/firewall4/templates/ruleset.uc

###–û—Ç–∫–ª—é—á–µ–Ω–∏–µ QUIC –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ (—Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º, dpi –æ–±—Ö–æ–¥–∞–º–∏)
uci add firewall rule
uci set firewall.@rule[-1].name='Block_UDP_80'
uci set firewall.@rule[-1].src='*'
uci set firewall.@rule[-1].dest_port='80'
uci set firewall.@rule[-1].proto='udp'
uci set firewall.@rule[-1].target='REJECT'

uci add firewall rule
uci set firewall.@rule[-1].name='Block_UDP_443'
uci set firewall.@rule[-1].src='*'
uci set firewall.@rule[-1].dest_port='443'
uci set firewall.@rule[-1].proto='udp'
uci set firewall.@rule[-1].target='REJECT'

uci commit firewall
/etc/init.d/firewall restart

###üîß –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è IPv6
curl -fsSL https://raw.githubusercontent.com/ilnur1111/routerr/refs/heads/main/disable_ipv6.sh | sh

###üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Podkop
sh <(wget -O - https://raw.githubusercontent.com/itdoginfo/podkop/refs/heads/main/install.sh)

###üöÄ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è YouTubeUnblock
curl -fsSL https://raw.githubusercontent.com/gfreemoon/install_youtubeunblock_universal/refs/heads/main/install%2Bconfig.sh | sh
